{"version":3,"sources":["../../../../units/urb-account-management-webapp/components/LogoutScreen.jsx"],"names":["styles","theme","card","minWidth","LogoutScreen","React","Component","constructor","props","context","_handle_onClick_Logout","setState","currentOperation","loc","window","location","host","protocol","hostname","port","response","fetch","method","credentials","headers","body","responseData","json","console","log","success","errorMessage","error","err","message","_handle_onClick_CancelLogout","_handle_onClick_TryAgain","_handle_onClick_Continue","replace","state","renderCreating","classes","renderSuccess","renderFailure","renderPrompt","render"],"mappings":"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","sourcesContent":["// @flow\n\nimport Button from '@material-ui/core/Button'\n\nimport Card from '@material-ui/core/Card'\n\nimport CardActions from '@material-ui/core/CardActions'\n\nimport CardContent from '@material-ui/core/CardContent'\n\nimport CardHeader from '@material-ui/core/CardHeader'\n\nimport LinearProgress from '@material-ui/core/LinearProgress'\n\nimport { withStyles } from '@material-ui/core/styles'\n\nimport Typography from '@material-ui/core/Typography'\n\nimport React from 'react'\n\nimport ResponsiveContentArea from '../../urb-appbase-webapp/components/ResponsiveContentArea'\n\nconst styles = theme => ({\n  card: {\n    minWidth: 400,\n  },\n})\n\nclass LogoutScreen extends React.Component<\n  {\n    classes: Object,\n  },\n  {\n    currentOperation: 'confirm' | 'logging out' | 'success' | 'failure',\n    errorMessage: string,\n  },\n> {\n  constructor( props: Object, context: Object ) {\n    super( props, context )\n\n    this.state = {\n      currentOperation: 'confirm',\n      errorMessage: '',\n    }\n  }\n\n  _handle_onClick_Logout = async() => {\n    this.setState({ currentOperation: 'logging out' })\n\n    try {\n      const loc = window.location\n      const host = loc.protocol + '//' + loc.hostname + ':' + loc.port\n\n      const response = await fetch( host + '/auth/logout', {\n        method: 'POST',\n        credentials: 'same-origin',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: '{}',\n      })\n\n      const responseData = await response.json()\n\n      console.log( 'LOGOUT USER RESPONSE' )\n      console.log( responseData )\n\n      if ( responseData.success ) {\n        // In case of success, notify user\n        this.setState({ currentOperation: 'success' })\n      } else {\n        // In case of error, tell user what the error is\n        this.setState({\n          currentOperation: 'failure',\n          errorMessage: responseData.error,\n        })\n      }\n    } catch ( err ) {\n      // In case response could not be received properly, tell the user\n      // In case of error, tell user what the error is\n      this.setState({\n        currentOperation: 'failure',\n        errorMessage:\n          'Did not receive proper response from server. Please try again. Message:' + err.message,\n      })\n    }\n  }\n\n  _handle_onClick_CancelLogout = () => {\n    this.setState({\n      currentOperation: 'failure',\n      errorMessage: 'User log out has been canceled',\n    })\n  }\n\n  _handle_onClick_TryAgain = () => {\n    this.setState({\n      currentOperation: 'confirm',\n      errorMessage: '',\n    })\n  }\n\n  _handle_onClick_Continue = () => {\n    window.location.replace( '/' )\n  }\n\n  renderCreating() {\n    const { classes } = this.props\n\n    return (\n      <Card className={classes.card}>\n        <CardHeader title=\"Creating user\" />\n        <CardContent>\n          <Typography component=\"p\">Logging out. Please wait ...</Typography>\n          <br /> <br />\n          <LinearProgress mode=\"query\" />\n        </CardContent>\n        <CardActions>\n          <Button onClick={this._handle_onClick_CancelLogout}>Cancel</Button>\n        </CardActions>\n      </Card>\n    )\n  }\n\n  renderSuccess() {\n    const { classes } = this.props\n\n    return (\n      <Card className={classes.card}>\n        <CardHeader title=\"Logout\" />\n        <CardContent>\n          <Typography component=\"p\">You have been logged out.</Typography>\n        </CardContent>\n        <CardActions>\n          <Button onClick={this._handle_onClick_Continue}>Continue</Button>\n        </CardActions>\n      </Card>\n    )\n  }\n\n  renderFailure() {\n    const { classes } = this.props\n    const { errorMessage } = this.state\n\n    return (\n      <Card className={classes.card}>\n        <CardHeader title=\"Creating user\" />\n        <CardContent>\n          <Typography component=\"p\">Failed logging out because: {errorMessage}!</Typography>\n        </CardContent>\n        <CardActions>\n          <Button onClick={this._handle_onClick_TryAgain}>Try Again</Button>\n        </CardActions>\n      </Card>\n    )\n  }\n\n  renderPrompt() {\n    const { classes } = this.props\n\n    return (\n      <Card className={classes.card}>\n        <CardHeader title=\"Log Out\" />\n        <CardContent>\n          <Typography component=\"p\">\n            You are currently logged in. Are you sure you want to log out?\n          </Typography>\n        </CardContent>\n        <CardActions>\n          <Button onClick={this._handle_onClick_Logout}>Yes, Log Out</Button>\n        </CardActions>\n      </Card>\n    )\n  }\n\n  render() {\n    const { currentOperation } = this.state\n\n    return (\n      <ResponsiveContentArea>\n        {currentOperation === 'confirm' && this.renderPrompt()}\n        {currentOperation === 'logging out' && this.renderCreating()}\n        {currentOperation === 'success' && this.renderSuccess()}\n        {currentOperation === 'failure' && this.renderFailure()}\n      </ResponsiveContentArea>\n    )\n  }\n}\n\nexport default withStyles( styles )( LogoutScreen )\n"],"file":"LogoutScreen.js"}