{"version":3,"sources":["../../../../units/rb-account-management-webapp/components/LogoutScreen.jsx"],"names":["styles","theme","card","minWidth","maxWidth","cardHeaderContentStyles","LogoutScreen","React","Component","constructor","props","context","_handle_onClick_Logout","setState","currentOperation","loc","window","location","host","protocol","hostname","port","response","fetch","method","credentials","headers","body","responseData","json","success","errorMessage","error","err","message","_handle_onClick_CancelLogout","_handle_onClick_TryAgain","_handle_onClick_Continue","replace","state","renderCreating","classes","renderSuccess","renderFailure","renderPrompt","render"],"mappings":"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","sourcesContent":["// @flow\n\nimport Button from '@material-ui/core/Button'\n\nimport Card from '@material-ui/core/Card'\n\nimport CardActions from '@material-ui/core/CardActions'\n\nimport CardContent from '@material-ui/core/CardContent'\n\nimport LinearProgress from '@material-ui/core/LinearProgress'\n\nimport { withStyles } from '@material-ui/core/styles'\n\nimport Typography from '@material-ui/core/Typography'\n\nimport IconLogout from 'mdi-material-ui/Logout'\nimport React from 'react'\n\nimport CompositeCardHeader, {\n  cardHeaderContentStyles\n} from '../../rb-appbase-webapp/components/CompositeCardHeader'\nimport ResponsiveContentArea from '../../rb-appbase-webapp/components/ResponsiveContentArea'\n\n//\n\nconst styles = theme => ({\n  card: {\n    minWidth: 350,\n    maxWidth: 1200\n  },\n  ...cardHeaderContentStyles\n})\n\n//\n\nclass LogoutScreen extends React.Component<\n  {\n    classes: Object\n  },\n  {\n    currentOperation: 'confirm' | 'logging out' | 'success' | 'failure',\n    errorMessage: string\n  }\n> {\n  constructor(props: Object, context: Object) {\n    super(props, context)\n\n    this.state = {\n      currentOperation: 'confirm',\n      errorMessage: ''\n    }\n  }\n\n  _handle_onClick_Logout = async() => {\n    this.setState({ currentOperation: 'logging out' })\n\n    try {\n      const loc = window.location\n      const host = loc.protocol + '//' + loc.hostname + ':' + loc.port\n\n      const response = await fetch(host + '/auth/logout', {\n        method: 'POST',\n        credentials: 'same-origin',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: '{}'\n      })\n\n      const responseData = await response.json()\n\n      if (responseData.success) {\n        // In case of success, notify user\n        this.setState({ currentOperation: 'success' })\n      } else {\n        // In case of error, tell user what the error is\n        this.setState({\n          currentOperation: 'failure',\n          errorMessage: responseData.error\n        })\n      }\n    } catch (err) {\n      // In case response could not be received properly, tell the user\n      // In case of error, tell user what the error is\n      this.setState({\n        currentOperation: 'failure',\n        errorMessage:\n          'Did not receive proper response from server. Please try again. Message:' +\n          err.message\n      })\n    }\n  }\n\n  _handle_onClick_CancelLogout = () => {\n    this.setState({\n      currentOperation: 'failure',\n      errorMessage: 'User log out has been canceled'\n    })\n  }\n\n  _handle_onClick_TryAgain = () => {\n    this.setState({\n      currentOperation: 'confirm',\n      errorMessage: ''\n    })\n  }\n\n  _handle_onClick_Continue = () => {\n    window.location.replace('/')\n  }\n\n  renderCreating() {\n    const { classes } = this.props\n\n    return (\n      <div>\n        <CompositeCardHeader\n          icon={<IconLogout htmlColor=\"#003c78\" />}\n          title=\"Log Out\"\n        />\n\n        <Card className={classes.card}>\n          <CardContent>\n            <Typography component=\"p\">Logging out. Please wait ...</Typography>\n            <br /> <br />\n            <LinearProgress mode=\"query\" />\n          </CardContent>\n          <CardActions>\n            <Button onClick={this._handle_onClick_CancelLogout}>Cancel</Button>\n          </CardActions>\n        </Card>\n      </div>\n    )\n  }\n\n  renderSuccess() {\n    const { classes } = this.props\n\n    return (\n      <div>\n        <CompositeCardHeader\n          icon={<IconLogout htmlColor=\"#003c78\" />}\n          title=\"Log Out\"\n        />\n\n        <Card className={classes.card}>\n          <CardContent>\n            <Typography component=\"p\">You have been logged out.</Typography>\n          </CardContent>\n          <CardActions>\n            <Button onClick={this._handle_onClick_Continue}>Continue</Button>\n          </CardActions>\n        </Card>\n      </div>\n    )\n  }\n\n  renderFailure() {\n    const { classes } = this.props\n    const { errorMessage } = this.state\n\n    return (\n      <div>\n        <CompositeCardHeader\n          icon={<IconLogout htmlColor=\"#003c78\" />}\n          title=\"Log Out\"\n        />\n\n        <Card className={classes.card}>\n          <CardContent>\n            <Typography component=\"p\">\n              Failed logging out because: {errorMessage}!\n            </Typography>\n          </CardContent>\n          <CardActions>\n            <Button onClick={this._handle_onClick_TryAgain}>Try Again</Button>\n          </CardActions>\n        </Card>\n      </div>\n    )\n  }\n\n  renderPrompt() {\n    const { classes } = this.props\n\n    return (\n      <div>\n        <CompositeCardHeader\n          icon={<IconLogout htmlColor=\"#003c78\" />}\n          title=\"Log Out\"\n        />\n\n        <Card className={classes.card}>\n          <CardContent>\n            <Typography component=\"p\">\n              You are currently logged in. Are you sure you want to log out?\n            </Typography>\n          </CardContent>\n          <CardActions>\n            <Button onClick={this._handle_onClick_Logout}>Yes, Log Out</Button>\n          </CardActions>\n        </Card>\n      </div>\n    )\n  }\n\n  render() {\n    const { currentOperation } = this.state\n\n    return (\n      <ResponsiveContentArea>\n        {currentOperation === 'confirm' && this.renderPrompt()}\n        {currentOperation === 'logging out' && this.renderCreating()}\n        {currentOperation === 'success' && this.renderSuccess()}\n        {currentOperation === 'failure' && this.renderFailure()}\n      </ResponsiveContentArea>\n    )\n  }\n}\n\nexport default withStyles(styles)(LogoutScreen)\n"],"file":"LogoutScreen.js"}